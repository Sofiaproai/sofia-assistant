<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistante Virtuelle - Sofia Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .status {
            font-size: 14px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .features-bar {
            background: #f8f9fa;
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .feature-btn {
            padding: 8px 12px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
            position: relative;
        }

        .feature-btn:hover {
            transform: scale(1.1);
            border-color: #667eea;
        }

        .feature-btn.active {
            background: #667eea;
            border-color: #667eea;
        }

        .tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .feature-btn:hover .tooltip {
            opacity: 1;
        }

        .chat-box {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .message.bot .message-content {
            background: #667eea;
            color: white;
            border-bottom-left-radius: 4px;
        }

        .message.user .message-content {
            background: #e9ecef;
            color: #333;
            border-bottom-right-radius: 4px;
        }

        .message-time {
            font-size: 10px;
            opacity: 0.6;
            margin-top: 4px;
        }

        .input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #userInput {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border 0.3s;
        }

        #userInput:focus {
            border-color: #667eea;
        }

        .voice-btn {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .voice-btn:hover {
            transform: scale(1.1);
        }

        .voice-btn.listening {
            animation: voicePulse 1s infinite;
            background: #ef4444;
        }

        @keyframes voicePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        #sendBtn {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            transition: transform 0.2s;
        }

        #sendBtn:hover {
            transform: scale(1.1);
        }

        #sendBtn:active {
            transform: scale(0.95);
        }

        .typing {
            display: none;
            padding: 12px 16px;
            background: #667eea;
            color: white;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            max-width: 70px;
        }

        .typing span {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            margin: 0 2px;
            animation: typing 1.4s infinite;
        }

        .typing span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .quick-replies {
            padding: 10px 20px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .quick-reply {
            padding: 8px 16px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-reply:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
            animation: slideIn 0.3s;
            z-index: 1000;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); }
            to { transform: translateX(0); }
        }

        .notification.show {
            display: block;
        }

        .weather-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-top: 10px;
        }

        .weather-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .temp {
            font-size: 36px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Sofia Pro</h1>
            <div class="status">
                <div class="status-dot"></div>
                <span>En ligne ‚Ä¢ Pr√™te √† vous aider</span>
            </div>
        </div>

        <div class="features-bar">
            <button class="feature-btn" onclick="toggleVoice()" id="voiceToggle">
                üé§
                <div class="tooltip">Commande vocale</div>
            </button>
            <button class="feature-btn" onclick="getWeather()">
                ‚òÄÔ∏è
                <div class="tooltip">M√©t√©o</div>
            </button>
            <button class="feature-btn" onclick="getJoke()">
                üòÑ
                <div class="tooltip">Blague</div>
            </button>
            <button class="feature-btn" onclick="getAdvice()">
                üí°
                <div class="tooltip">Conseil</div>
            </button>
            <button class="feature-btn" onclick="clearChat()">
                üóëÔ∏è
                <div class="tooltip">Effacer</div>
            </button>
        </div>

        <div class="chat-box" id="chatBox">
            <div class="message bot">
                <div class="message-content">
                    Bonjour ! Je suis Sofia Pro, votre assistante virtuelle avanc√©e. 
                    
J'ai maintenant des super-pouvoirs :
üé§ Reconnaissance vocale
‚òÄÔ∏è Informations m√©t√©o
üòÑ Blagues et divertissement
üí° Conseils quotidiens
üßÆ Calculs avanc√©s

Essayez de me parler ou cliquez sur les ic√¥nes ! üòä
                </div>
            </div>
        </div>

        <div class="quick-replies">
            <div class="quick-reply" onclick="sendQuickReply('Raconte-moi une blague')">Blague üòÑ</div>
            <div class="quick-reply" onclick="sendQuickReply('Quel temps fait-il ?')">M√©t√©o ‚òÄÔ∏è</div>
            <div class="quick-reply" onclick="sendQuickReply('Donne-moi un conseil')">Conseil üí°</div>
            <div class="quick-reply" onclick="sendQuickReply('Aide')">Aide ‚ùì</div>
        </div>

        <div class="input-area">
            <button class="voice-btn" id="voiceBtn" onclick="startVoiceRecognition()">üé§</button>
            <input type="text" id="userInput" placeholder="√âcrivez votre message..." onkeypress="handleKeyPress(event)">
            <button id="sendBtn" onclick="sendMessage()">‚û§</button>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        const chatBox = document.getElementById('chatBox');
        const userInput = document.getElementById('userInput');
        let isListening = false;
        let recognition;

        // Configuration de la reconnaissance vocale
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'fr-FR';
            recognition.continuous = false;
            recognition.interimResults = false;

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                userInput.value = transcript;
                sendMessage();
                stopListening();
            };

            recognition.onerror = () => {
                stopListening();
                showNotification('Erreur de reconnaissance vocale', 'error');
            };

            recognition.onend = () => {
                stopListening();
            };
        }

        // Base de connaissances √©tendue
        const knowledgeBase = {
            'bonjour': 'Bonjour ! Ravi de vous parler. Comment puis-je vous aider aujourd\'hui ?',
            'salut': 'Salut ! Super de vous revoir ! Que puis-je faire pour vous ?',
            '√ßa va': 'Je vais tr√®s bien, merci ! Tous mes circuits fonctionnent √† merveille ! Et vous ?',
            'qui es-tu': 'Je suis Sofia Pro, votre assistante virtuelle intelligente. Je peux :\n‚Ä¢ R√©pondre √† vos questions\n‚Ä¢ Vous donner la m√©t√©o\n‚Ä¢ Raconter des blagues\n‚Ä¢ Faire des calculs\n‚Ä¢ Reconna√Ætre votre voix\n‚Ä¢ Et bien plus encore !',
            'aide': 'üéØ Voici ce que je peux faire :\n\nüé§ Commande vocale - Cliquez sur le micro\n‚òÄÔ∏è M√©t√©o en temps r√©el\nüòÑ Blagues et humour\nüí° Conseils quotidiens\nüßÆ Calculs math√©matiques\n‚è∞ Heure et date\nüó®Ô∏è Conversation naturelle\n\nEssayez de me poser une question !',
            'heure': `Il est actuellement ${new Date().toLocaleTimeString('fr-FR', {hour: '2-digit', minute: '2-digit'})}.`,
            'date': `Nous sommes le ${new Date().toLocaleDateString('fr-FR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}.`,
            'merci': 'De rien ! C\'est toujours un plaisir de vous aider ! üòä N\'h√©sitez pas si vous avez d\'autres questions !',
            'au revoir': 'Au revoir ! √Ä tr√®s bient√¥t ! Passez une excellente journ√©e ! üëã',
            'comment tu vas': 'Je vais super bien ! Merci de demander. Mes algorithmes sont au top aujourd\'hui ! üòÑ',
            'ton nom': 'Je m\'appelle Sofia Pro ! Je suis une assistante virtuelle de nouvelle g√©n√©ration. Enchant√©e !',
        };

        const jokes = [
            "Pourquoi les plongeurs plongent-ils toujours en arri√®re et jamais en avant ? Parce que sinon ils tombent dans le bateau ! üòÑ",
            "Qu'est-ce qu'un crocodile qui surveille la pharmacie ? Un Lacoste-garde ! üêä",
            "Qu'est-ce qu'un canif ? Un petit fien ! üòÇ",
            "Pourquoi les poissons n'aiment pas jouer au tennis ? Parce qu'ils ont peur du filet ! üéæ",
            "Comment appelle-t-on un chat tomb√© dans un pot de peinture le jour de No√´l ? Un chat-peint de No√´l ! üé®",
            "Qu'est-ce qu'un vampire avec une past√®que ? Un mort qui a soif ! üßõ",
        ];

        const advices = [
            "üí° Conseil du jour : Prenez 5 minutes pour m√©diter. Cela r√©duit le stress de 40% !",
            "üí° Conseil du jour : Buvez un verre d'eau d√®s le r√©veil pour hydrater votre corps.",
            "üí° Conseil du jour : Faites une pause √©cran toutes les 20 minutes pour prot√©ger vos yeux.",
            "üí° Conseil du jour : Marchez 10 000 pas par jour pour rester en bonne sant√©.",
            "üí° Conseil du jour : Lisez 10 pages d'un livre chaque jour pour stimuler votre cerveau.",
            "üí° Conseil du jour : Souriez ! Cela active 14 muscles et am√©liore votre humeur.",
        ];

        function addMessage(content, isUser = false) {
            const msgDiv = document.createElement('div');
            msgDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = content;
            
            msgDiv.appendChild(contentDiv);
            chatBox.appendChild(msgDiv);
            chatBox.scrollTop = chatBox.scrollHeight;

            if (!isUser) {
                speak(content);
            }
        }

        function showTyping() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = '<div class="typing" style="display: block;"><span></span><span></span><span></span></div>';
            chatBox.appendChild(typingDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function hideTyping() {
            const typing = document.getElementById('typingIndicator');
            if (typing) typing.remove();
        }

        function getResponse(input) {
            const normalizedInput = input.toLowerCase().trim();
            
            // Calculs
            if (/^[\d+\-*/().\s]+$/.test(normalizedInput)) {
                try {
                    const result = eval(normalizedInput);
                    return `üßÆ Le r√©sultat est : ${result}`;
                } catch {
                    return '‚ùå D√©sol√©, je n\'ai pas pu calculer √ßa. V√©rifiez votre expression.';
                }
            }

            // Blagues
            if (normalizedInput.includes('blague') || normalizedInput.includes('rigole') || normalizedInput.includes('dr√¥le')) {
                return jokes[Math.floor(Math.random() * jokes.length)];
            }

            // Conseils
            if (normalizedInput.includes('conseil') || normalizedInput.includes('astuce') || normalizedInput.includes('tips')) {
                return advices[Math.floor(Math.random() * advices.length)];
            }

            // M√©t√©o
            if (normalizedInput.includes('m√©t√©o') || normalizedInput.includes('temps')) {
                return '‚òÄÔ∏è Pour la m√©t√©o pr√©cise de votre r√©gion, cliquez sur l\'ic√¥ne m√©t√©o ‚òÄÔ∏è en haut ! Je peux vous donner des informations g√©n√©rales si vous voulez.';
            }

            // Recherche dans la base de connaissances
            for (let key in knowledgeBase) {
                if (normalizedInput.includes(key)) {
                    return knowledgeBase[key];
                }
            }

            // Capacit√©s
            if (normalizedInput.includes('capacit√©') || normalizedInput.includes('fonction')) {
                return 'üöÄ Je suis une assistante virtuelle avanc√©e ! Je peux :\n‚Ä¢ Comprendre votre voix üé§\n‚Ä¢ Vous donner la m√©t√©o ‚òÄÔ∏è\n‚Ä¢ Raconter des blagues üòÑ\n‚Ä¢ Donner des conseils üí°\n‚Ä¢ Faire des calculs üßÆ\n‚Ä¢ Discuter naturellement üí¨';
            }

            // R√©ponse contextuelle
            if (normalizedInput.length < 3) {
                return 'Pourriez-vous pr√©ciser votre question ? ü§î';
            }
            
            return 'C\'est une question int√©ressante ! Je fais de mon mieux pour apprendre chaque jour. Pourriez-vous reformuler ou me demander autre chose ? üòä';
        }

        function sendMessage() {
            const message = userInput.value.trim();
            
            if (!message) return;
            
            addMessage(message, true);
            userInput.value = '';
            
            showTyping();
            
            setTimeout(() => {
                hideTyping();
                const response = getResponse(message);
                addMessage(response, false);
            }, 800 + Math.random() * 700);
        }

        function sendQuickReply(message) {
            userInput.value = message;
            sendMessage();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function startVoiceRecognition() {
            if (!recognition) {
                showNotification('Reconnaissance vocale non support√©e par votre navigateur', 'error');
                return;
            }

            if (isListening) {
                stopListening();
            } else {
                isListening = true;
                document.getElementById('voiceBtn').classList.add('listening');
                recognition.start();
                showNotification('üé§ Je vous √©coute...', 'info');
            }
        }

        function stopListening() {
            isListening = false;
            document.getElementById('voiceBtn').classList.remove('listening');
            if (recognition) {
                recognition.stop();
            }
        }

        function toggleVoice() {
            startVoiceRecognition();
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const cleanText = text.replace(/[üé§‚òÄÔ∏èüòÑüí°üßÆ‚ùåüöÄüí¨ü§îüòäüëãüêäüéæüé®üßõ‚è∞üó®Ô∏è‚ùì‚û§üóëÔ∏è]/g, '');
                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.lang = 'fr-FR';
                utterance.rate = 1.1;
                utterance.pitch = 1;
                window.speechSynthesis.speak(utterance);
            }
        }

        function getWeather() {
            showTyping();
            setTimeout(() => {
                hideTyping();
                const weatherData = {
                    temp: Math.floor(Math.random() * 15) + 15,
                    condition: ['Ensoleill√©', 'Nuageux', 'Partiellement nuageux', 'Pluvieux'][Math.floor(Math.random() * 4)],
                    humidity: Math.floor(Math.random() * 40) + 40
                };
                
                const response = `‚òÄÔ∏è M√©t√©o actuelle :\n\nüå°Ô∏è Temp√©rature : ${weatherData.temp}¬∞C\n‚òÅÔ∏è Conditions : ${weatherData.condition}\nüíß Humidit√© : ${weatherData.humidity}%\n\nNote : Pour des donn√©es pr√©cises, je recommande de v√©rifier un service m√©t√©o local !`;
                addMessage(response, false);
            }, 1000);
        }

        function getJoke() {
            showTyping();
            setTimeout(() => {
                hideTyping();
                const joke = jokes[Math.floor(Math.random() * jokes.length)];
                addMessage(joke, false);
            }, 800);
        }

        function getAdvice() {
            showTyping();
            setTimeout(() => {
                hideTyping();
                const advice = advices[Math.floor(Math.random() * advices.length)];
                addMessage(advice, false);
            }, 800);
        }

        function clearChat() {
            chatBox.innerHTML = '';
            addMessage('üí¨ Conversation effac√©e ! Comment puis-je vous aider ?', false);
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification show';
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        userInput.focus();
    </script>
</body>
</html>
